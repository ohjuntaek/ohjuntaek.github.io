# 안드로이드 MVC, MVP, MVVM

- [Realm 안드로이드 MVC, MVP, MVVM](https://academy.realm.io/kr/posts/eric-maxwell-mvc-mvp-and-mvvm-on-android/)

## MVC

- 맨날 쓰던거
- 모델, 뷰, 컨트롤러
- 모델 : 데이터 + 상태 + 비즈니스 로직
  - 딱 느낌이 안온다.. tictactoe mvc 예제를 보자
  - 젤 뭐가 많은 Board 클래스를 보자
  - 데이터 : cells = new Cell[3][3]과 같이 뭐 말그대로 보여줘야하는? 필요한? 데이터.. 아닐까? 뭐 모델의 필드..
  - 상태 : 이건 뭐냐? 데이터랑 차이가 뭐지.. 필드중에 상태랑 데이터로 나뉘는건가 GameState state; 같이..
  - 비즈니스 로직 : 로직을 모델에 다 때려박았네???? 여튼 모델에 뭐 mark restart 등등..
- 뷰 : 모델의 표현
  - 뭐 하위(연관된?) 모델에 대한 이해가 없고 사용자가 뭔가 행동 할 때 뭐 해야할지 몰라서 멍청하다나..
    - 글킨하지.. 뷰는 걍 생각해보면 layout 이잖아 암것도 모르지 걍 UI 보여주는거 아닌가?
  - 왜 그러냐 : 뷰가 멍청할 수록 모델에 종속되지 않아 변화에 유연하기 때문
- 컨트롤러 : 앱을 묶어주는 접착제
  - 모델의 데이터의 변화에 따라 컨트롤러가 뷰의 상태를 적절하게 업데이트 시켜준다.
  - 안드로이드에서 액티비티나 프래그먼트
  - 생각해보면 액티비티에서 데이터에 따라서 뭐 어떻게 해라.. 이런 걸 알려주나?
    - 뭔가 설명이 이상한거 같은데.. 그림이 더 잘 설명하는 듯
  
  > MVC 그림 참조해라
  
  - 그림 보면 View에서 notify하면 Controller에서 모델이랑 상호작용?을 하고 뷰에 Setup 한다고 써있네
  - 일케 생각하면 아주 쉬운데.. 상호작용? 이 좀 애매하네
  
  - 사실 웹 할때 모델은 걍 데이터라 생각했고 뷰는 진짜 UI라 생각했고 Controller에서 뭐 비즈니스 로직 처리한다고 생각했는데
  - 내가 알고 있는게 틀린건지... 근데 사실 비즈니스 로직? 은 정확히 하면 Controller보단 Service에서 처리하긴 하는데
  - [웹 MVC 링크](https://hyoje420.tistory.com/36) : 보니깐 비즈니스 로직 모델에서 하네 지금까지 대충 알고 있었구만
  - 그래서 이 틱택톡 예제처럼 Model에서 Model 관련된, 뭐 Board 같으면 mark(), isWinningMoveByPlayer() 같은게 있네
  - 그럼 Activity, 즉 Controller엔 뭐있냐? 앞에서 조진 mark() 같은걸 언제 써먹냐? 이런걸 정해주는 거지.. 오케이
  
  > 그럼 여기서 딱 의문이 들지 아니 비즈니스 로직을 데이터에 때려박는다고 너무 이상한데??? => MVP로 가자 => 가 아니네... 밑에 나온다 AnemicDomain
  
  - 그전에 단점
    - MVC는 좋지만 테스트가 어렵다 왜? 컨트롤러가 안드로이드 API에 깊게 종속?? 왜?
      - Activity에서 써먹으니깐 당연한거 아냐
    - 모듈화 및 유연성 어렵다 : 컨트롤러가 뷰에 단단히 결합되어있다. => 당연하지? 뷰하나당 컨트롤러 거의 하나
    - 유지 보수 : 뭐 이상한게 있네 Anemic Domain Model??
      - 소위 뭐 게터세터만 있는 객체.. 이거 맞는 말이지 또 용어가 있구만
      - [번역한게 요깄네](https://m.blog.naver.com/PostView.nhn?blogId=muchine98&logNo=220304821784&proxyReferer=https%3A%2F%2Fwww.google.com%2F)
        - 여기 말이 나오네 서비스 객체에 도메인 로직을 집어넣고 도메인 모델을 데이터로.. 그래 맨날 이래했었는데
        - 이게 무슨 객체지향이랑 반대라나... 생각해보니까 그러네
        - 객체지향 강박이란다. 그런거 같은데. 도메인 모델 설계를 하면서? 안하는데? 여튼 이득이 없단다.
        - 데이터베이스 매핑의 어려움? 뭐가 어렵나 O/R? 이게 뭐지 어디서 봤는데 Object Relation인가 ORM에서 봤는듯.. 뭔 트랜잭션 스크립트라네..
        - 에릭 에반스 도메인 주도 설계라는 책에서는 일케 한단다.
        - 애플리케이션 계층(서비스 계층의 다른 이름) : 뭐야이게.. 도메인 객체에 작업을 위임하는 역할인가
        - 도메인 계층(모델 계층) : 업무의 기본 개념, 정보, 규칙을 나타내는 역할
        > 결국 핵심은 서비스 계층이랑 도메인 계층을 잘 섞어 쓰고 핵심은 도메인에 해란거네..
    - 뭐하다가 여기까지 왔지.. 여튼 유지보수가 이런 빈약한 도메인 모델을 쓰면 참 컨트롤러가 비대해진단다 경험했지 이건
    
## MVP
  
- 뭐 뷰와 액티비티가 컨트롤러에 책임에 묶이지 않고 자연스레 결합? 상당히 추상적이네
- 모델 : MVC랑 똑같단다.
- 뷰 : 유일한 변화는 액티비티/프래그먼트가 뷰의 일부로 간주된다.. 먼소리지
  - 액티비티가 뷰 인터페이스를 구현해서 프레젠터가 코드를 만들 인터페이스를 갖도록 하는게 좋다
    - 뷰 인터페이스? 뷰를 인터페이스로 만들어서 뭔가 기능 명세하나보네
  - 이렇게 하면 특정 뷰와 결합되지 않고 가상 뷰를 구현해서 간단한 유닛 테스트 실행 가능...
  - 먼소리야? 뷰가 특정 프레젠터, 즉 컨트롤러에 결합이 안되는데 어떻게 한단거지? 코드를 봐야알지
- 프리젠터
  - 본질적으로는 컨트롤러. 자꾸 헷갈린다 이제 생각패턴을 바꾸자
  - 그냥 인터페이스다!
  - 극단적 MVP는 프리젠터가 절대로 어떤 API나 코드도 참조하지 않는다.. 인터페이스인데 그게 되나? 구현할때 말하는건가..
  
> 또 다시 그림이 나온다.
- 뷰에선 당연히 notify하고 프레젠터에서 모델이랑 인터엑트하는건 똑같네 그리고 View에 ask view to setup itself... 뷰가 지가 셋업한다고? 코드를 보자.

- 자 프레젠터를 보면 일단 생성자에 model = new Board() 한다 이거 프레젠터 구현체가 따로 만드는구나
- 중요한게 있네 생성할 때 view인터페이스를 구현한 걸 받네
- 프레젠터도 onCreate, Puase, Resume, Destory 다있네? 가 아니라 프레젠터 인터페이스에서 쓴거구나

- 뭐 대충 알겠는데.. 그래서 이 프레젠터를 어떻게 쓰나 보자.

- 일단 액티비티에서는 View 인터페이스를 구현한다.
- 그리고 밖에서 구현한 프레젠터구현체를 생성시킨다.
- 그리고 findByViewId해주고 프레젠터구현한걸 적절하게 넣는다. 
  - 이렇게 하면 일단 컨트롤러에서는 모델을 쓰는 걸 액티비티에서 다 해서 의존성이 매우 높았는데, 이걸 일단 분리할 수 있다는 장점

- 자꾸 뷰에게 무언가를 표시하는 방법을 지시하지 않고 표시한 내용만 전달한다는데 이게 이해가 안되는데
  - 일단 뷰 인터페이스를 보면 showWinner, clearWinnerDisplay, clearButton, setButtonText 가 있네
  - 즉 액티비티와 레이아웃이 묶이는게 아니고, View 인터페이스랑 레이아웃이 묶이니깐 훨씬 의존성이 줄어든다.. 
  
  - 그러니깐 이렇게 하는데... 사용법은 별거없네 걍 인터페이스로 액티비티에 있던 로직이랑 뷰랑 때려박아라는거 같은데
  - 뭔가 어떻게보면 똑같은거 같은데 테스트 용이 + 모듈화 라서 쓰는갑네 걍 하나의 진짜 패턴이네..
  
  
+ MVVM은 나중에

+ [버즈빌 MVP 링크](https://www.buzzvil.com/ko/2017/01/31/android-mvp-pattern-what-why-and-how/), 적용하고 나중에 한번
+ [thdev.tech 블로그 MVP](https://thdev.tech/androiddev/2016/11/28/Android-MVP-One/), 구글 아키텍처 예제가 있어서 좋음(Contract 사용)
+ [정I외 블로그 MVP](https://black-jin0427.tistory.com/149), 이거는 Room, Dagger까지 써서 아주 좋은 예제네

> 적용 후 수정...

  
  
  
  
  
  
  
  
  
  
  
    
    
    
    
  
  
  
  
  
  
  
  
  
  
  
  
  

